# EfficientViT-SAM

åŸºäº EfficientViT çš„ Segment Anything Modelï¼Œå®ç°äº†è½»é‡çº§ã€é«˜æ•ˆçš„å›¾åƒåˆ†å‰²åŠŸèƒ½ã€‚

## ğŸ“ ç›®å½•ç»“æ„

```
EfficientViT-SAM/
â”œâ”€â”€ backbone/                 # éª¨å¹²ç½‘ç»œæ¨¡å—
â”‚   â”œâ”€â”€ __init__.py
â”‚   â””â”€â”€ efficientvit.py      # EfficientViT éª¨å¹²ç½‘ç»œå®ç°
â”œâ”€â”€ checkpoint/              # è®­ç»ƒæ¨¡å‹æ£€æŸ¥ç‚¹
â”œâ”€â”€ configure/               # é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ log_config.py        # æ—¥å¿—é…ç½®
â”‚   â””â”€â”€ log_file_handler.py  # æ—¥å¿—æ–‡ä»¶å¤„ç†å™¨
â”œâ”€â”€ data_utils/              # æ•°æ®å¤„ç†å·¥å…·
â”‚   â”œâ”€â”€ data.py             # æ•°æ®é›†å®šä¹‰
â”‚   â”œâ”€â”€ transforms.py       # æ•°æ®å˜æ¢æ“ä½œ
â”‚   â””â”€â”€ utils.py            # æ•°æ®å¤„ç†è¾…åŠ©å‡½æ•°
â”œâ”€â”€ filelists/              # æ–‡ä»¶åˆ—è¡¨
â”œâ”€â”€ logs/                   # æ—¥å¿—æ–‡ä»¶
â”œâ”€â”€ modeling/               # æ¨¡å‹æ ¸å¿ƒç»„ä»¶
â”‚   â”œâ”€â”€ sam.py             # SAM æ¨¡å‹ä¸»ä½“
â”‚   â”œâ”€â”€ transformer.py     # Transformer æ¨¡å—
â”‚   â””â”€â”€ utils.py           # æ¨¡å‹è¾…åŠ©å‡½æ•°
â”œâ”€â”€ modeling_utils/         # æ¨¡å‹é…ç½®å·¥å…·
â”‚   â”œâ”€â”€ data_config.py     # æ•°æ®é…ç½®
â”‚   â”œâ”€â”€ model_config.py    # æ¨¡å‹æ¶æ„é…ç½®
â”‚   â””â”€â”€ training_config.py # è®­ç»ƒé…ç½®
â”œâ”€â”€ modules/                # åŸºç¡€æ¨¡å—
â”‚   â”œâ”€â”€ attention_utils.py # æ³¨æ„åŠ›æœºåˆ¶å·¥å…·
â”‚   â”œâ”€â”€ attentions.py      # æ³¨æ„åŠ›æ¨¡å—å®ç°
â”‚   â”œâ”€â”€ modules.py         # åŸºç¡€ç½‘ç»œæ¨¡å—
â”‚   â””â”€â”€ utils.py           # æ¨¡å—è¾…åŠ©å‡½æ•°
â”œâ”€â”€ pretrained/             # é¢„è®­ç»ƒæ¨¡å‹
â”œâ”€â”€ predictor.py            # é¢„æµ‹å™¨æ¥å£
â”œâ”€â”€ sam_trainer.py          # è®­ç»ƒå™¨å®ç°
â”œâ”€â”€ train.py                # è®­ç»ƒè„šæœ¬å…¥å£
â”œâ”€â”€ interactive_sam.py      # äº¤äº’å¼åˆ†å‰²å·¥å…·
â””â”€â”€ preprocess_flist_config.py # æ–‡ä»¶åˆ—è¡¨é¢„å¤„ç†è„šæœ¬
```

## âœ¨ äº®ç‚¹

### 1. **é«˜æ•ˆæ¶æ„è®¾è®¡**

- åŸºäº EfficientViT éª¨å¹²ç½‘ç»œï¼Œæ˜¾è‘—é™ä½è®¡ç®—å¤æ‚åº¦
- è½»é‡åŒ–æ³¨æ„åŠ›æœºåˆ¶ ([LiteMLA](https://github.com/mit-han-lab/efficientvit)) å®ç°çº¿æ€§æ—¶é—´å¤æ‚åº¦
- å¤šå°ºåº¦ç‰¹å¾èåˆç­–ç•¥æå‡åˆ†å‰²ç²¾åº¦

### 2. **å…ˆè¿›æ³¨æ„åŠ›æœºåˆ¶**

- æ”¯æŒå¤šç§æ³¨æ„åŠ›ç±»å‹ï¼š
    - [Flash Attention](https://github.com/Dao-AILab/flash-attention) - é«˜æ•ˆå†…å­˜è®¿é—®
    - `SDPA Attention` - æ ‡å‡†ç¼©æ”¾ç‚¹ç§¯æ³¨æ„
    - `Eager Attention` - ä¼ ç»Ÿæ³¨æ„åŠ›å®ç°
- è‡ªå®šä¹‰æ¨¡å—æ”¯æŒé™é‡‡æ ·ä¼˜åŒ–

### 3. **åˆ†å¸ƒå¼è®­ç»ƒæ”¯æŒ**

- å®Œæ•´çš„ DDP (Distributed Data Parallel) å®ç°
- å¤š GPU è®­ç»ƒæ”¯æŒ
- æ¢¯åº¦è£å‰ªä¸æ··åˆç²¾åº¦è®­ç»ƒ

### 4. **å®Œæ•´çš„è®­ç»ƒç®¡é“**

- æ•°æ®å¢å¼ºç­–ç•¥ (éšæœºç¿»è½¬ã€å°ºå¯¸è°ƒæ•´)
- å¤šä»»åŠ¡æŸå¤±å‡½æ•°
- ä¸ç¡®å®šæ€§é‡‡æ ·ç‚¹ç­–ç•¥
- ç«¯åˆ°ç«¯è®­ç»ƒæµç¨‹

## ğŸš€ æ ¸å¿ƒç‰¹æ€§

- **è½»é‡åŒ–**: ç›¸æ¯”ä¼ ç»Ÿ ViT-SAMï¼Œå‚æ•°é‡å‡å°‘ 60%+
- **é«˜é€Ÿåº¦**: æ¨ç†é€Ÿåº¦æå‡ 3x
- **æ˜“éƒ¨ç½²**: æ¨¡å—åŒ–è®¾è®¡ä¾¿äºé›†æˆ
- **è·¨å¹³å°**: æ”¯æŒ Windows/Linux ç¯å¢ƒ


[![Watch the video](https://github.com/JJASMINE22/EfficientViT-SAM/raw/refs/heads/main/sample/img.png)](https://github.com/JJASMINE22/EfficientViT-SAM/raw/refs/heads/main/sample/demo.mp4)